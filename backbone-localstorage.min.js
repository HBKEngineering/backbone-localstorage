/*! backbone-localstorage v0.1.0 14-11-2013, 16:58:49 */
(function(a){var b="",c="unknown:",d=a.sync,e=a.LocalStorage={};e.VERSION="0.1.0",e._setData=function(a,c){localStorage.setItem(b+a,JSON.stringify(c))},e._getData=function(a){return JSON.parse(localStorage.getItem(_prefix+a))},e._reset=function(){for(var a in localStorage)if(0===a.indexOf(b))return localStorage.removeItem(a)},e.sync=function(a,b,c){if("read"===a&&"object"==typeof this.localStorage){var f=this.localStorage.id?this.localStorage.id:b.id,g=e._getData(f+":timestamp");if(void 0!==f&&null!==f)if(c.forceRefresh||!g||this.localStorage.maxRefresh&&(new Date).getTime()-g>this.localStorage.maxRefresh){var h=c.success;c.success=function(a){try{e._setData(f,a),e._setData(f+":timestamp",(new Date).getTime())}catch(b){b===QUOTA_EXCEEDED_ERR&&e._reset()}h&&h.apply(this,arguments)},d.apply(this,[a,b,c])}else setTimeout(function(a){c.success(e._getData(a),"success",null)},0,f);d.apply(this,arguments)}else d.apply(this,arguments)},e.setVersion=function(a){c=a},e.getVersion=function(){return c},e.setPrefix=function(a){b=a},e.getPrefix=function(){return b},void 0!==localStorage&&(a.sync=e.sync)}).call(this,Backbone);