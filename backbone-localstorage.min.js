/*! backbone-localstorage v0.1.0 15-11-2013, 11:22:28 */
(function(a){var b="unknown",c="",d=a.Backbone.sync,e=a.Backbone.LocalStorage={};e.VERSION="0.1.0",e._setData=function(c,d){a.localStorage.setItem(b+":"+c,JSON.stringify(d))},e._getData=function(c){var d=a.localStorage.getItem(b+":"+c);return"string"==typeof d?JSON.parse(d):d},e._clear=function(c){if(c)a.localStorage.clear();else for(var d in a.localStorage)if(0===d.indexOf(b))return a.localStorage.removeItem(d)},e.sync=function(a,b,c){if("read"===a&&"object"==typeof this.localStorage){var f=b.localStorage.id?b.localStorage.id:b.id,g=e._getData(f+":timestamp");if(void 0!==f&&null!==f)if(c.forceRefresh||void 0!==g&&b.localStorage.maxRefresh&&(new Date).getTime()-g>b.localStorage.maxRefresh){var h=c.success;c.success=function(a){try{e._setData(f,a),e._setData(f+":timestamp",(new Date).getTime())}catch(b){b===QUOTA_EXCEEDED_ERR&&e._clear()}h&&h.apply(this,arguments)},d.apply(this,[a,b,c])}else{for(var i in localStorage)console.log("found: "+i);c.success.apply(this,[e._getData(f),"success",null])}else d.apply(this,arguments)}else d.apply(this,arguments)},e.setVersion=function(a){c=a},e.getVersion=function(){return c},e.setPrefix=function(a){b=a},e.getPrefix=function(){return b},void 0!==localStorage&&(a.Backbone.sync=e.sync)}).call(this,window,Backbone);